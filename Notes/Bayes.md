## 贝叶斯定理与HIV检测

很多疾病的检测结果通常是阴性(-)和阳性(+)两种情况，艾滋病(AIDS)也不例外。目前，HIV(艾滋病病毒)检测方式是做血清抗体检测。任何医学检测都不会100%准确，数据的统计结果显示，真正得了艾滋病的患者在接受HIV检测后,结果呈现阳性的概率为99.8%，而健康人群检测结果为阴性的概率为99%。总体来说，检测结果还是很可靠的，得病的人基本会被检测出来，没有得病的人也能被准确甄选出来。  
老王是A国居民，A国人口总共有100万，A国的艾滋病感染率为0.0666%，这个概率属于艾滋病高发区。某天老王参加完聚会后感觉身体不舒服，于是去医院检查，检测结果是HIV阳性，老王非常害怕。那么老王实际得艾滋病的概率是多大呢？  
我们将使用贝叶斯定理[1]的方法计算老王的得病概率。
```
P(A|B) = P(B|A)P(A)/P(B)            [1]
```
贝叶斯公式具体解释就是：在B出现的前提下A出现的概率，等于以A为前提B出现的概率与A出现概率的乘积，再除以B出现的概率。换句话说，就是后验概率和先验概率的关系。

根据故事背景，要求的是老王在检测为阳性的情况下患病的概率，即P(患病|阳性)，
我们假设：
* A: 患者得这种病
* B: 检验结果呈阳性

已知条件如下：
1. P(A)=0.0666% -- A国的艾滋病感染率为0.0666%。
2. P(B|A)=0.998 --艾滋病患者在接受检测后的结果呈阳性的概率为99.8%。
3. P(B|A拔)=0.01 --健康人群检测结果为阴性的概率为99%，则为阳性的概率为1%。
4. A国总人口为100万。
则P(A|B)是多少? 即检验结果呈阳性并传染上该病的概率是多少?

根据贝叶斯定理，在血液检测阳性的的人群中，确定感染HIV的概率：
```
P(患病|阳性) = P(阳性|患病) X P(患病) / ( P(阳性|患病) X P(患病) + P(阳性|未患病) X P(未患病) )
            = 0.998 * 0.000666 / 0.998 * 0.000666 + 0.01 * (1-0.000666) = 0.062363
```
在老王检测结果呈阳性的情况下，老王得艾滋病的概率仅为6.24%。

各类人群的人数总结如下表所示：
|结果|患者|健康者|总计|
|----|----|----|----|
|阳性| 655 | 9993 | 10658 |
|阴性| 1 | 989341 | 989342 |

即P(患病|阳性) = 665/10658 = 6.24% 。

### 为什么检测阳性而患病概率这么低？  
这是因为虽然老王的检测结果呈阳性，但是假阳性的人数很多，因此即使老王的检测结果为阳性，也存在很大的概率并未得病。这也是艾滋病筛查需要检测多次的原因，通过多轮检测，层层筛选后，概率自然就会提高。

-----
![Bayes](http://www.ligene.cn/images/bayes.jpg)
Thomas Bayes (1701-1761)，英国牧师、业余数学家、统计师。贝叶斯出身于牧师之家，其父Joshua Bayes是伦敦长老会牧师。1719年，18岁的贝叶斯继承家族传统，进入爱丁堡大学修读逻辑学和神学，毕业后顺理成章成为一位牧师。在牧师的工作之余，贝叶斯对数学和逻辑推断抱有强烈的兴趣，有传言说，贝叶斯希望通过统计概率，证明上帝的存在。然而，终其一生，他没有实现这个愿望。被冠以“Bayes”之名的贝叶斯定理，则是在贝叶斯过世之后，由另一位牧师Richard Price从他的笔记中整理发表的。
